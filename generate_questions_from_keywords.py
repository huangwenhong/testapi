# -*- coding: utf-8 -*-
"""
ä¼˜åŒ–ç‰ˆï¼šæ ¹æ®å…³é”®è¯ç”Ÿæˆæµ‹è¯•é—®é¢˜
å¢å¼ºç‰ˆï¼šä¿®å¤å…³é”®è¯æå–å’Œé—®é¢˜ç”Ÿæˆé€»è¾‘
"""

from docx import Document
import json
import re


def clean_keyword(keyword):
    """æ¸…ç†å…³é”®è¯ï¼Œç§»é™¤å¼•å·å’Œå¤šä½™å­—ç¬¦"""
    cleaned = re.sub(r'[""''""'']', '', keyword)
    cleaned = cleaned.strip()
    return cleaned


def extract_keywords_from_doc(doc):
    """ä»æ–‡æ¡£ä¸­æå–æ‰€æœ‰å…³é”®è¯ï¼ˆæ¸…ç†åï¼‰"""
    keywords = set()
    
    for para in doc.paragraphs:
        text = para.text.strip()
        if text:
            parts = re.split(r'[,\sã€ï¼Œ]+', text)
            for part in parts:
                part = clean_keyword(part)
                if part and len(part) > 1 and not part.isdigit():
                    if part not in ["å…³é”®è¯", "å…³é”®è¯ï¼š", "å®¢æˆ·-æµ‹è¯•é»„æ–‡é¸¿", "ä¸šåŠ¡å‘˜é»„æ–‡é¸¿"]:
                        keywords.add(part)
    
    return list(keywords)


def generate_questions_from_keywords(keywords):
    """æ ¹æ®å…³é”®è¯ç”Ÿæˆ100ä¸ªé—®é¢˜"""
    
    # æ ¸å¿ƒä¸šåŠ¡å…³é”®è¯æ˜ å°„åˆ°é—®é¢˜æ¨¡æ¿
    keyword_templates = {
        "ä¸œåŠ›4å·äº§å“": [
            "ä¸œåŠ›4å·äº§å“8æœˆä»½ä¸æ‰£é™¤ç§¯åˆ†çš„å¹³å‡å•ä»·æ˜¯å¤šå°‘ï¼Ÿ",
            "ä¸œåŠ›4å·äº§å“æœ¬æœˆ1â€”14æ—¥çš„é”€é‡æ˜¯å¤šå°‘ï¼Œç¯æ¯”ä¸Šä¸ªæœˆåŒæœŸå˜åŒ–å¦‚ä½•ï¼Ÿ",
            "è¯·åˆ†æä¸œåŠ›4å·äº§å“çš„ä»·æ ¼æ³¢åŠ¨è¶‹åŠ¿",
            "ä¸œåŠ›4å·äº§å“ä¸ç«å“çš„ä»·æ ¼å¯¹æ¯”å¦‚ä½•ï¼Ÿ",
        ],
        "ä¸œè¯š": [
            "ä»Šæ—¥ä¸œè¯šè®¢å•äº¤æ˜“é¢æ˜¯å¤šå°‘ï¼Ÿ",
            "ä¸œè¯šæœ¬æœˆçš„æ¯æ—¥æ¥å•æƒ…å†µå¦‚ä½•ï¼ŒåŒ…å«åŒæ¯”å’Œç¯æ¯”å˜åŒ–å—ï¼Ÿ",
            "2025å¹´9æœˆ7æ—¥ä¸œè¯šæ¶¨ä»·åçš„å•é‡å¯¹æ¯”æ¶¨ä»·å‰æœ‰ä»€ä¹ˆå½±å“ï¼Ÿ",
            "ä¸œè¯šåœ¨æ¸©å·å¸‚åœºçš„è¡¨ç°å¦‚ä½•ï¼Ÿ",
        ],
        "å®‡ç•…": [
            "å®‡ç•…2025å¹´9æœˆ1æ—¥åˆ°2æ—¥æ¥å•é¢ç§¯å’Œé”€å”®é¢æ˜¯å¤šå°‘ï¼Ÿ",
            "æŸ¥è¯¢å®‡ç•…9æœˆ8æ—¥è‡³14æ—¥å–æ¶ˆçš„è®¢å•ï¼Œè¦æ±‚è¾“å‡ºå®¢æˆ·æ•°ã€ç¬”æ•°ã€æ€»é¢ç§¯",
            "å®‡ç•…æœ¬æœˆè®¢å•æ˜¯å¦æœ‰å¼‚å¸¸ï¼Ÿ",
            "è¯·åˆ†æå®‡ç•…çš„è®¢å•è¶‹åŠ¿å˜åŒ–",
        ],
        "ç¥æ³°": [
            "é’ˆå¯¹å˜‰å…´ç¥æ³°25å¹´8æœˆ10æ—¥è®¢å•é¢ç§¯å¼‚åŠ¨å¢é•¿åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ",
            "ç¥æ³°åŒ…è£…2025å¹´8æœˆ10æ—¥è®¢å•é¢ç§¯æ˜¯å¦æœ‰å¼‚å¸¸ï¼Ÿ",
            "ç¥æ³°æœ¬æœˆé”€å”®ä¸šç»©å¦‚ä½•ï¼Ÿ",
            "è¯·åˆ†æç¥æ³°äº§å“çš„å¸‚åœºè¡¨ç°",
        ],
        "æ¬£é¾™åŒ…è£…": [
            "æŸ¥è¯¢æ¬£é¾™åŒ…è£…2025å¹´9æœˆ8æ—¥-14æ—¥å–æ¶ˆçš„è®¢å•",
            "æ¬£é¾™åŒ…è£…æœ¬æœˆå®¢æˆ·ä¸‹å•æƒ…å†µå¦‚ä½•ï¼Ÿ",
            "è¯·åˆ†ææ¬£é¾™åŒ…è£…çš„é”€å”®è¶‹åŠ¿",
        ],
        "æ¸©å·": [
            "æ¸©å·å¸‚åœºä»Šå¤©æ¥äº†å¤šå°‘å•ï¼Ÿ",
            "æ¸©å·å¸‚åœºä¸Šæœˆè®¢å•æƒ…å†µå¦‚ä½•ï¼Ÿ",
            "è¯·åˆ†ææ¸©å·å¸‚åœºçš„åŒºåŸŸé”€å”®åˆ†å¸ƒ",
            "æ¸©å·æœ¬æœˆæ¥å•æœ€å¥½çš„ä¸šåŠ¡å‘˜æ˜¯è°ï¼Ÿ",
        ],
        "é‡‘å": [
            "é‡‘åå¸‚åœº2025å¹´9æœˆ1å·-8å·è®¢å•åˆ†æï¼Œç¯æ¯”æƒ…å†µå¦‚ä½•ï¼Ÿ",
            "æŸ¥è¯¢é‡‘åå¸‚åœº2025å¹´8æœˆæœ‰ä¸‹å•9æœˆæœªä¸‹å•çš„å®¢æˆ·",
            "é‡‘åæœ¬æœˆè®¢å•è¶‹åŠ¿å¦‚ä½•ï¼Ÿ",
            "è¯·åˆ†æé‡‘åå¸‚åœºçš„å®¢æˆ·åˆ†å¸ƒ",
        ],
        "å˜‰å…´": [
            "å˜‰å…´å¸‚åœºæœ¬æœˆé”€å”®æƒ…å†µå¦‚ä½•ï¼Ÿ",
            "è¯·åˆ†æå˜‰å…´åŒºåŸŸçš„æ¥å•åˆ†å¸ƒ",
            "å˜‰å…´æœ¬æœˆè®¢å•é‡‘é¢æ˜¯å¤šå°‘ï¼Ÿ",
        ],
        "ä¸šåŠ¡å‘˜": [
            "æŸ¥è¯¢æœ¬æœˆæ¥å•æœ€å¥½çš„10ä¸ªä¸šåŠ¡å‘˜",
            "æœ¬æœˆä¸šåŠ¡å‘˜é”€å”®é¢ç§¯ä¸é”€å”®é‡‘é¢top10æ˜¯è°ï¼Ÿ",
            "9æœˆç¬¬ä¸€å‘¨çš„æ¥å•é‡æŒ‰ä¸šåŠ¡å‘˜æ±‡æ€»æ’åºï¼Œå–æœ€å¤§çš„10ä¸ª",
            "æœ¬æœˆä¸šåŠ¡å‘˜ä¸šç»©å¦‚ä½•æ’åï¼Ÿ",
        ],
        "å®¢æˆ·": [
            "æœ¬æœˆä¸‹å•é‡‘é¢æœ€é«˜çš„å®¢æˆ·æ˜¯è°ï¼Ÿ",
            "è¯·æŸ¥è¯¢æœ¬æœˆæœªä¸‹å•çš„å®¢æˆ·åå•",
            "å“ªäº›å®¢æˆ·æœ¬æœˆä½“é‡ä¸‹æ»‘äº†ï¼Ÿ",
            "è¯·åˆ†æå¤§ä¸æ™®é€šå®¢æˆ·çš„å·®å¼‚å®¢æˆ·",
        ],
        "è®¢å•": [
            "ä»Šæ—¥è®¢å•æ€»æ•°æ˜¯å¤šå°‘ï¼Ÿ",
            "æœ¬æœˆè®¢å•ç¬”æ•°ä¸ä¸Šæœˆå¯¹æ¯”å¦‚ä½•ï¼Ÿ",
            "æœ¬æœˆå–æ¶ˆäº†å“ªäº›è®¢å•ï¼Ÿ",
            "è¯·åˆ†æè®¢å•å¼‚å¸¸å¢é•¿çš„åŸå› ",
        ],
        "æ¥å•": [
            "æœ¬æœˆæ¥å•é‡æ˜¯å¤šå°‘ï¼Œç¯æ¯”å˜åŒ–å¦‚ä½•ï¼Ÿ",
            "æœ¬æœˆæ¥å•è¶‹åŠ¿å¦‚ä½•ï¼Ÿ",
            "æœ¬æœˆæ¥å•æœ€å¥½çš„10ä¸ªåŒºåŸŸæ˜¯å“ªäº›ï¼Ÿ",
            "è¯·åˆ†ææ¥å•é‡å¼‚å¸¸å¢é•¿çš„åŸå› ",
        ],
        "é¢ç§¯": [
            "æœ¬æœˆæ¥å•é¢ç§¯æ˜¯å¤šå°‘ï¼Œç¯æ¯”å˜åŒ–å¦‚ä½•ï¼Ÿ",
            "æœ¬æœˆè®¢å•é¢ç§¯å¼‚å¸¸çš„çš„å®¢æˆ·æœ‰å“ªäº›ï¼Ÿ",
            "è¯·åˆ†ææ¥å•é¢ç§¯çš„åŒºåŸŸåˆ†å¸ƒ",
            "æœ¬æœˆå–æ¶ˆè®¢å•çš„æ€»é¢ç§¯æ˜¯å¤šå°‘ï¼Ÿ",
        ],
        "é‡‘é¢": [
            "æœ¬æœˆæ¥å•é‡‘é¢æ˜¯å¤šå°‘ï¼Ÿ",
            "æœ¬æœˆé”€å”®é¢æœ€é«˜çš„å®¢æˆ·æ˜¯è°ï¼Ÿ",
            "æœ¬æœˆé‡‘é¢ç¯æ¯”å˜åŒ–å¦‚ä½•ï¼Ÿ",
            "è¯·åˆ†æé‡‘é¢å¼‚å¸¸çš„åŸå› ",
        ],
        "é”€å”®é¢": [
            "æœ¬æœˆé”€å”®é¢æ˜¯å¤šå°‘ï¼Ÿ",
            "æœ¬æœˆé”€å”®é¢è¶‹åŠ¿å¦‚ä½•ï¼Ÿ",
            "è¯·åˆ†æé”€å”®é¢çš„åŒºåŸŸåˆ†å¸ƒ",
            "æœ¬æœˆé”€å”®é¢ç¯æ¯”ä¸Šæœˆå˜åŒ–å¦‚ä½•ï¼Ÿ",
        ],
        "è¶‹åŠ¿": [
            "æœ¬æœˆè®¢å•è¶‹åŠ¿å¦‚ä½•ï¼Ÿ",
            "è¯·åˆ†ææœ¬æœˆæ¥å•é‡åŒæ¯”ä¸Šä¸ªæœˆçš„å˜åŒ–è¶‹åŠ¿",
            "è¯·æŸ¥çœ‹æœ¬æœˆå‡ä»·å˜åŒ–è¶‹åŠ¿",
            "æœ¬æœˆè®¢å•è¶‹åŠ¿æ˜¯å¦å‡ºç°å¼‚å¸¸ï¼Ÿ",
        ],
        "åˆ†æ": [
            "è¯·å¯¹æœ¬æœˆè®¢å•è¿›è¡Œç»¼åˆåˆ†æ",
            "è¯·åˆ†ææœ¬æœˆå¼‚å¸¸è®¢å•çš„åŸå› ",
            "è¯·å¯¹æœ¬æœˆé”€å”®æ•°æ®è¿›è¡ŒåŒæ¯”åˆ†æ",
            "è¯·å¯¹æœ¬æœˆå®¢æˆ·ä½“é‡å˜åŒ–è¿›è¡Œåˆ†æ",
        ],
        "ç¯æ¯”": [
            "æœ¬æœˆè®¢å•ç¯æ¯”ä¸Šæœˆå˜åŒ–å¦‚ä½•ï¼Ÿ",
            "æœ¬æœˆæ¥å•é‡ç¯æ¯”ä¸Šä¸ªæœˆåŒæœŸæœ‰ä»€ä¹ˆå˜åŒ–ï¼Ÿ",
            "æœ¬æœˆé”€å”®é¢ç¯æ¯”ä¸Šæœˆå¢é•¿è¿˜æ˜¯ä¸‹é™ï¼Ÿ",
            "è¯·å¯¹æ¯”æœ¬æœˆä¸ä¸Šæœˆçš„æ¥å•æƒ…å†µ",
        ],
        "åŒæ¯”": [
            "æœ¬æœˆæ¥å•é‡åŒæ¯”ä¸Šä¸ªæœˆçš„å˜åŒ–è¶‹åŠ¿å¦‚ä½•ï¼Ÿ",
            "æœ¬æœˆè®¢å•åŒæ¯”å»å¹´å˜åŒ–å¦‚ä½•ï¼Ÿ",
            "è¯·å¯¹æ¯”æœ¬æœˆä¸å»å¹´åŒæœŸçš„é”€å”®æ•°æ®",
            "æœ¬æœˆä¸šç»©åŒæ¯”å¢é•¿è¿˜æ˜¯ä¸‹é™ï¼Ÿ",
        ],
        "å¼‚å¸¸": [
            "æœ¬æœˆæ˜¯å¦æœ‰è®¢å•å¼‚å¸¸ï¼Ÿ",
            "è¯·åˆ†ææœ¬æœˆè®¢å•å¼‚å¸¸å¢é•¿çš„åŸå› ",
            "æœ¬æœˆå¼‚å¸¸è®¢å•æ˜¯å¦ä¸å»¶å•æœ‰å…³ç³»ï¼Ÿ",
            "è¯·è¯†åˆ«æœ¬æœˆä½“é‡ä¸‹æ»‘çš„å®¢æˆ·",
        ],
        "å–æ¶ˆ": [
            "æœ¬æœˆå–æ¶ˆäº†å“ªäº›è®¢å•ï¼Ÿ",
            "æœ¬æœˆå–æ¶ˆè®¢å•çš„æ•°é‡å’Œé¢ç§¯æ˜¯å¤šå°‘ï¼Ÿ",
            "æœ¬æœˆå–æ¶ˆè®¢å•çš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ",
            "è¯·åˆ†ææœ¬æœˆå–æ¶ˆè®¢å•çš„è¶‹åŠ¿",
        ],
        "æœ¬æœˆ": [
            "æœ¬æœˆè®¢å•æ€»æ•°æ˜¯å¤šå°‘ï¼Ÿ",
            "æœ¬æœˆæ¥å•é‡‘é¢æ˜¯å¤šå°‘ï¼Ÿ",
            "æœ¬æœˆæ¯æ—¥æ¥å•è¶‹åŠ¿å¦‚ä½•ï¼Ÿ",
            "æœ¬æœˆè®¢å•ç¬”æ•°æ˜¯å¤šå°‘ï¼Ÿ",
        ],
        "å¸‚åœº": [
            "å„å¸‚åœºçš„æœ¬æœˆæ¥å•æƒ…å†µå¦‚ä½•ï¼Ÿ",
            "è¯·å¯¹æ¯”ä¸åŒå¸‚åœºçš„æ¥å•è¡¨ç°",
            "æœ¬æœˆå“ªä¸ªå¸‚åœºæ¥å•é‡æœ€é«˜ï¼Ÿ",
            "è¯·åˆ†æå„å¸‚åœºçš„é”€å”®åˆ†å¸ƒ",
        ],
        "8æœˆ": [
            "2025å¹´8æœˆçš„æ¥å•æƒ…å†µå¦‚ä½•ï¼Ÿ",
            "8æœˆè®¢å•é‡‘é¢æ˜¯å¤šå°‘ï¼Ÿ",
            "8æœˆæ¥å•é‡ç¯æ¯”7æœˆå˜åŒ–å¦‚ä½•ï¼Ÿ",
            "è¯·å¯¹æ¯”8æœˆå’Œ7æœˆçš„æ¥å•æ•°æ®",
        ],
        "2025å¹´12æœˆ": [
            "2025å¹´12æœˆçš„æ¥å•ç›®æ ‡æ˜¯å¤šå°‘ï¼Ÿ",
            "è¯·é¢„æµ‹2025å¹´12æœˆçš„é”€å”®æƒ…å†µ",
            "2025å¹´12æœˆè®¢å•è¶‹åŠ¿å¦‚ä½•ï¼Ÿ",
            "è¯·åˆ†æ2025å¹´12æœˆçš„é”€å”®ç­–ç•¥",
        ],
        "äº§å“": [
            "æœ¬æœˆå„ç±»äº§å“çš„æ¥å•æƒ…å†µå¦‚ä½•ï¼Ÿ",
            "è¯·å¯¹æ¯”ä¸åŒäº§å“çš„é”€å”®è¡¨ç°",
            "æœ¬æœˆå“ªä¸ªäº§å“æ¥å•é‡æœ€é«˜ï¼Ÿ",
            "è¯·åˆ†æäº§å“çš„ä»·æ ¼åˆ†å¸ƒ",
        ],
        "åŒ…è£…": [
            "åŒ…è£…ç±»äº§å“çš„æœ¬æœˆé”€å”®æƒ…å†µå¦‚ä½•ï¼Ÿ",
            "è¯·åˆ†æåŒ…è£…äº§å“çš„æ¥å•è¶‹åŠ¿",
            "åŒ…è£…äº§å“æœ¬æœˆè®¢å•é‡‘é¢æ˜¯å¤šå°‘ï¼Ÿ",
        ],
        "é‡‘é¢": [
            "æœ¬æœˆæ¥å•é‡‘é¢æ˜¯å¤šå°‘ï¼Ÿ",
            "æœ¬æœˆé”€å”®é¢æœ€é«˜çš„å®¢æˆ·æ˜¯è°ï¼Ÿ",
            "æœ¬æœˆé‡‘é¢ç¯æ¯”ä¸Šæœˆå˜åŒ–å¦‚ä½•ï¼Ÿ",
            "è¯·åˆ†æé‡‘é¢å¼‚å¸¸çš„åŸå› ",
        ],
    }
    
    # é€šç”¨é—®é¢˜æ¨¡æ¿
    general_templates = [
        "è¯·åˆ†æ{keyword}åœ¨2025å¹´9æœˆçš„æ¥å•æƒ…å†µ",
        "è¯·æŸ¥è¯¢{keyword}2025å¹´8æœˆçš„é”€å”®æ•°æ®",
        "{keyword}æœ¬æœˆçš„è®¢å•é‡‘é¢æ˜¯å¤šå°‘ï¼Ÿ",
        "{keyword}è¿‘ä¸‰ä¸ªæœˆçš„é”€é‡è¶‹åŠ¿å¦‚ä½•ï¼Ÿ",
        "è¯·å¯¹æ¯”{keyword}2025å¹´7æœˆå’Œ8æœˆçš„æ¥å•å˜åŒ–",
        "è¯·åˆ†æ{keyword}çš„ä»·æ ¼æ³¢åŠ¨åŸå› ",
        "{keyword}æœ¬æœˆæ˜¯å¦å‡ºç°å¼‚å¸¸è®¢å•ï¼Ÿ",
        "{keyword}æœ¬æœˆtop10å®¢æˆ·æ˜¯è°ï¼Ÿ",
        "è¯·æŸ¥è¯¢{keyword}çš„è®¢å•ç¬”æ•°",
        "{keyword}ä¸šåŠ¡å‘˜æœ¬æœˆä¸šç»©å¦‚ä½•ï¼Ÿ",
    ]
    
    # ç¦æ­¢ä½¿ç”¨é€šç”¨æ¨¡æ¿çš„å…³é”®è¯ï¼ˆè¿™äº›å…³é”®è¯å¤ªæ³›åŒ–ï¼Œä¸é€‚åˆå¥—ç”¨æ¨¡æ¿ï¼‰
    forbidden_keywords = {
        "åˆ†æ", "å¸‚åœº", "æœ¬æœˆ", "8æœˆ", "9æœˆ", "ç¯æ¯”", "åŒæ¯”", "è¶‹åŠ¿", 
        "å¼‚å¸¸", "è®¢å•", "æ¥å•", "é‡‘é¢", "é¢ç§¯", "é‡‘é¢", "é”€å”®é¢", 
        "äº§å“", "åŒ…è£…", "å®¢æˆ·", "ä¸šåŠ¡å‘˜", "å–æ¶ˆ", "æ¸©å·", "é‡‘å", "å˜‰å…´"
    }
    
    questions = []
    used_questions = set()
    
    # é¦–å…ˆä½¿ç”¨ç‰¹å®šæ¨¡æ¿ç”Ÿæˆé—®é¢˜
    for keyword, templates in keyword_templates.items():
        for template in templates:
            question = template
            if len(questions) >= 100:
                break
            
            if question not in used_questions:
                used_questions.add(question)
                
                # ç”Ÿæˆå…³é”®è¯åˆ—è¡¨
                kw_list = [keyword]
                if "2025å¹´" in question:
                    kw_list.append("2025å¹´")
                if "æœ¬æœˆ" in question:
                    kw_list.append("æœ¬æœˆ")
                if "ç¯æ¯”" in question:
                    kw_list.append("ç¯æ¯”")
                if "åŒæ¯”" in question:
                    kw_list.append("åŒæ¯”")
                if "è¶‹åŠ¿" in question:
                    kw_list.append("è¶‹åŠ¿")
                if "å¼‚å¸¸" in question:
                    kw_list.append("å¼‚å¸¸")
                
                questions.append({
                    "id": len(questions) + 1,
                    "question": question,
                    "keywords": kw_list
                })
    
    # ä½¿ç”¨é€šç”¨æ¨¡æ¿è¡¥å……é—®é¢˜ï¼ˆä»…é™æœ‰ä¸šåŠ¡æ„ä¹‰çš„å…³é”®è¯ï¼‰
    if len(questions) < 100:
        for template in general_templates:
            if len(questions) >= 100:
                break
            
            for keyword in keywords:
                if len(questions) >= 100:
                    break
                
                # è·³è¿‡ç¦æ­¢ä½¿ç”¨é€šç”¨æ¨¡æ¿çš„å…³é”®è¯
                if keyword in forbidden_keywords:
                    continue
                
                question = template.replace("{keyword}", keyword)
                if question not in used_questions:
                    used_questions.add(question)
                    
                    kw_list = [keyword]
                    if "2025å¹´" in question:
                        kw_list.append("2025å¹´")
                    if "æœ¬æœˆ" in question:
                        kw_list.append("æœ¬æœˆ")
                    
                    questions.append({
                        "id": len(questions) + 1,
                        "question": question,
                        "keywords": kw_list
                    })
    
    # å¦‚æœä»ä¸è¶³100ä¸ªï¼Œä½¿ç”¨ä¸šåŠ¡å…³é”®è¯å¡«å……
    if len(questions) < 100:
        business_keywords = [
            "ä¸œåŠ›4å·äº§å“", "ä¸œè¯š", "å®‡ç•…", "ç¥æ³°", "æ¬£é¾™åŒ…è£…", 
            "æ¸©å·å¸‚åœº", "é‡‘åå¸‚åœº", "å˜‰å…´å¸‚åœº"
        ]
        additional_templates = [
            "æŸ¥è¯¢{keyword}æœ¬æœˆçš„é”€å”®æ•°æ®",
            "{keyword}æœ¬æœˆè®¢å•é‡‘é¢æ˜¯å¤šå°‘ï¼Ÿ",
            "è¯·åˆ†æ{keyword}çš„æ¥å•è¶‹åŠ¿",
            "{keyword}æœ¬æœˆæ˜¯å¦æœ‰å¼‚å¸¸è®¢å•ï¼Ÿ",
            "è¯·å¯¹æ¯”{keyword}ä¸ä¸Šæœˆçš„æ¥å•å˜åŒ–",
        ]
        
        for template in additional_templates:
            if len(questions) >= 100:
                break
            
            for keyword in business_keywords:
                if len(questions) >= 100:
                    break
                
                question = template.replace("{keyword}", keyword)
                if question not in used_questions:
                    used_questions.add(question)
                    
                    questions.append({
                        "id": len(questions) + 1,
                        "question": question,
                        "keywords": [keyword]
                    })
    
    return questions


def main():
    # æ–‡ä»¶è·¯å¾„
    keywords_docx_path = r"d:\HWH\apitest\apitest\ai_answer_evaluator\å…³é”®è¯.docx"
    output_json_path = r"d:\HWH\apitest\apitest\ai_answer_evaluator\generated_test_cases.json"
    
    # è¯»å–å…³é”®è¯æ–‡æ¡£
    doc = Document(keywords_docx_path)
    
    # æå–å…³é”®è¯
    keywords = extract_keywords_from_doc(doc)
    print(f"æå–çš„å…³é”®è¯: {keywords}")
    print(f"å…³é”®è¯æ€»æ•°: {len(keywords)}")
    
    # ç”Ÿæˆé—®é¢˜
    questions = generate_questions_from_keywords(keywords)
    
    print(f"\nâœ… æˆåŠŸç”Ÿæˆ {len(questions)} ä¸ªæµ‹è¯•ç”¨ä¾‹")
    
    # ä¿å­˜åˆ°JSONæ–‡ä»¶
    if questions:
        with open(output_json_path, 'w', encoding='utf-8') as f:
            json.dump(questions, f, ensure_ascii=False, indent=2)
        
        print(f"ğŸ“„ å·²ä¿å­˜åˆ°: {output_json_path}")
        
        # æ˜¾ç¤ºé¢„è§ˆ
        print(f"\nè½¬æ¢ç»“æœé¢„è§ˆ:")
        print("-" * 80)
        for case in questions[:15]:
            print(f"ID: {case['id']}")
            print(f"é—®é¢˜: {case['question']}")
            print(f"å…³é”®è¯: {case['keywords']}")
            print("-" * 40)
        
        if len(questions) > 15:
            print(f"... è¿˜æœ‰ {len(questions) - 15} ä¸ªç”¨ä¾‹")


if __name__ == "__main__":
    main()
